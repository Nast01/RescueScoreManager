<UserControl x:Class="RescueScoreManager.Modules.Planning.Views.PlanningStructureCompetitionView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:loc="clr-namespace:RescueScoreManager.Localization"
             xmlns:viewModels="clr-namespace:RescueScoreManager.Modules.Planning.ViewModels">
    
    <UserControl.DataContext>
        <viewModels:PlanningStructureCompetitionViewModel />
    </UserControl.DataContext>
    
    <UserControl.Resources>
        <BooleanToVisibilityConverter x:Key="BoolToVisConverter" />
        <Style x:Key="EventCardStyle" TargetType="Border">
            <Setter Property="Background" Value="White" />
            <Setter Property="CornerRadius" Value="8" />
            <Setter Property="Padding" Value="20" />
            <Setter Property="Margin" Value="0,0,0,15" />
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect Color="#000000" Opacity="0.1" BlurRadius="10" ShadowDepth="2" />
                </Setter.Value>
            </Setter>
        </Style>
        
        <Style x:Key="SectionHeaderStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="18" />
            <Setter Property="FontWeight" Value="SemiBold" />
            <Setter Property="Foreground" Value="#2C3E50" />
            <Setter Property="Margin" Value="0,0,0,15" />
        </Style>
    </UserControl.Resources>
    
    <Grid>
        <ScrollViewer VerticalScrollBarVisibility="Auto">
            <StackPanel>
                <!-- Individual Events Section -->
                <StackPanel Margin="0,0,0,30">
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,20">
                        <Rectangle Fill="#FF9800" Width="20" Height="20" RadiusX="3" RadiusY="3" Margin="0,0,10,0" />
                        <TextBlock Text="{loc:Translate IndividualEvents}" Style="{StaticResource SectionHeaderStyle}" Margin="0" />
                        <Border Background="#FFF3E0" CornerRadius="12" Padding="8,4" Margin="15,0,0,0">
                            <TextBlock Text="{loc:Translate EventsConfigurationStatus}" FontSize="12" Foreground="#F57C00" />
                        </Border>
                    </StackPanel>
                    
                    <!-- Events List -->
                    <ItemsControl ItemsSource="{Binding Events}">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <Border Style="{StaticResource EventCardStyle}">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>
                                        
                                        <StackPanel Grid.Column="0">
                                            <TextBlock Text="{Binding Name}" FontSize="16" FontWeight="SemiBold" Foreground="#2C3E50" />
                                            <StackPanel Orientation="Horizontal" Margin="0,5,0,0">
                                                <TextBlock Text="{Binding ParticipantCount}" FontWeight="SemiBold" Foreground="#7F8C8D" />
                                                <TextBlock Text="{loc:Translate ParticipantsSeparator}" Foreground="#7F8C8D" />
                                                <TextBlock Text="{Binding Category}" Foreground="#7F8C8D" />
                                            </StackPanel>
                                        </StackPanel>
                                        
                                        <Button Grid.Column="1" Content="{loc:Translate Configure}" Background="#4A90E2" Foreground="White"
                                                BorderThickness="0" Padding="15,8" FontSize="12"
                                                Command="{Binding DataContext.ConfigureEventCommand, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                                CommandParameter="{Binding}">
                                            <Button.Template>
                                                <ControlTemplate TargetType="Button">
                                                    <Border Background="{TemplateBinding Background}" CornerRadius="5" Padding="{TemplateBinding Padding}">
                                                        <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" />
                                                    </Border>
                                                </ControlTemplate>
                                            </Button.Template>
                                        </Button>
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </StackPanel>
            </StackPanel>
        </ScrollViewer>
        
        <!-- Configuration Modal -->
        <Border Background="#80000000" Visibility="{Binding IsConfigurationModalOpen, Converter={StaticResource BoolToVisConverter}}">
            <Border Background="White" CornerRadius="10" MaxWidth="800" MaxHeight="600" 
                    HorizontalAlignment="Center" VerticalAlignment="Center" Padding="0">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>
                    
                    <!-- Modal Header -->
                    <Border Grid.Row="0" Background="#4A90E2" CornerRadius="10,10,0,0" Padding="20,15">
                        <Grid>
                            <TextBlock Text="{loc:Translate PhaseConfiguration}" FontSize="16" FontWeight="SemiBold" Foreground="White" />
                            <Button Content="✕" Background="Transparent" BorderThickness="0" Foreground="White" 
                                    FontSize="16" HorizontalAlignment="Right" Padding="5"
                                    Command="{Binding CloseConfigurationCommand}" />
                        </Grid>
                    </Border>
                    
                    <!-- Modal Content -->
                    <ScrollViewer Grid.Row="1" Padding="20" VerticalScrollBarVisibility="Auto">
                        <StackPanel>
                            <!-- Configuration Type Toggle -->
                            <Grid Margin="0,0,0,20">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>
                                
                                <StackPanel Grid.Column="0" Orientation="Horizontal">
                                    <Ellipse Fill="#4A90E2" Width="20" Height="20" Margin="0,0,10,0" />
                                    <TextBlock Text="{loc:Translate GlobalConfiguration}" FontSize="14" Foreground="#7F8C8D" VerticalAlignment="Center" />
                                </StackPanel>
                                
                                <Border Grid.Column="1" Background="#4A90E2" CornerRadius="25" Padding="15,8" 
                                        HorizontalAlignment="Right" MaxWidth="200">
                                    <StackPanel Orientation="Horizontal">
                                        <Ellipse Fill="White" Width="16" Height="16" Margin="0,0,8,0" />
                                        <TextBlock Text="{loc:Translate ByCategories}" FontSize="12" Foreground="White" FontWeight="SemiBold" />
                                    </StackPanel>
                                </Border>
                            </Grid>
                            
                            <!-- Categories Configuration -->
                            <Grid Margin="0,0,0,30">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>
                                
                                <!-- Senior Category -->
                                <Border Grid.Column="0" Background="#F8F9FA" CornerRadius="8" Padding="15" Margin="0,0,10,0">
                                    <StackPanel>
                                        <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                                            <Ellipse Fill="#FF9800" Width="16" Height="16" Margin="0,0,8,0" />
                                            <TextBlock Text="{loc:Translate Senior}" FontWeight="SemiBold" FontSize="14" />
                                            <Border Background="#E3F2FD" CornerRadius="10" Padding="6,2" Margin="10,0,0,0">
                                                <TextBlock Text="18" FontSize="11" FontWeight="Bold" Foreground="#1976D2" />
                                            </Border>
                                        </StackPanel>
                                        
                                        <Grid>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="Auto" />
                                            </Grid.RowDefinitions>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto" />
                                                <ColumnDefinition Width="*" />
                                            </Grid.ColumnDefinitions>
                                            
                                            <TextBlock Grid.Row="0" Grid.Column="0" Text="{loc:Translate ParticipantsLabel}" FontSize="12" Foreground="#7F8C8D" Margin="0,0,10,0" />
                                            <TextBlock Grid.Row="0" Grid.Column="1" Text="6" FontWeight="SemiBold" FontSize="12" />
                                            
                                            <TextBlock Grid.Row="1" Grid.Column="0" Text="{loc:Translate AgeLabel}" FontSize="12" Foreground="#7F8C8D" Margin="0,5,10,0" />
                                            <TextBlock Grid.Row="1" Grid.Column="1" Text="14-17 ans" FontWeight="SemiBold" FontSize="12" Margin="0,5,0,0" />
                                        </Grid>
                                    </StackPanel>
                                </Border>
                                
                                <!-- Junior Category -->
                                <Border Grid.Column="1" Background="#F8F9FA" CornerRadius="8" Padding="15" Margin="10,0,0,0">
                                    <StackPanel>
                                        <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                                            <Ellipse Fill="#4A90E2" Width="16" Height="16" Margin="0,0,8,0" />
                                            <TextBlock Text="{loc:Translate Junior}" FontWeight="SemiBold" FontSize="14" />
                                            <Border Background="#E3F2FD" CornerRadius="10" Padding="6,2" Margin="10,0,0,0">
                                                <TextBlock Text="6" FontSize="11" FontWeight="Bold" Foreground="#1976D2" />
                                            </Border>
                                        </StackPanel>
                                        
                                        <Grid>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="Auto" />
                                            </Grid.RowDefinitions>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto" />
                                                <ColumnDefinition Width="*" />
                                            </Grid.ColumnDefinitions>
                                            
                                            <TextBlock Grid.Row="0" Grid.Column="0" Text="{loc:Translate ParticipantsLabel}" FontSize="12" Foreground="#7F8C8D" Margin="0,0,10,0" />
                                            <TextBlock Grid.Row="0" Grid.Column="1" Text="6" FontWeight="SemiBold" FontSize="12" />
                                        </Grid>
                                    </StackPanel>
                                </Border>
                            </Grid>
                            
                            <!-- Phase Configuration Buttons -->
                            <StackPanel Orientation="Horizontal" Margin="0,0,0,20">
                                <Button Content="{loc:Translate Series}" Background="#2E3A59" Foreground="White" 
                                        BorderThickness="0" Padding="15,8" FontSize="12" Margin="0,0,10,0">
                                    <Button.Template>
                                        <ControlTemplate TargetType="Button">
                                            <Border Background="{TemplateBinding Background}" CornerRadius="5" Padding="{TemplateBinding Padding}">
                                                <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" />
                                            </Border>
                                        </ControlTemplate>
                                    </Button.Template>
                                </Button>
                                <Button Content="{loc:Translate Semifinals}" Background="Transparent" Foreground="#7F8C8D" 
                                        BorderThickness="1" BorderBrush="#E0E0E0" Padding="15,8" FontSize="12" Margin="0,0,10,0">
                                    <Button.Template>
                                        <ControlTemplate TargetType="Button">
                                            <Border Background="{TemplateBinding Background}" BorderBrush="{TemplateBinding BorderBrush}" 
                                                    BorderThickness="{TemplateBinding BorderThickness}" CornerRadius="5" 
                                                    Padding="{TemplateBinding Padding}">
                                                <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" />
                                            </Border>
                                        </ControlTemplate>
                                    </Button.Template>
                                </Button>
                                <Button Content="{loc:Translate Finals}" Background="Transparent" Foreground="#7F8C8D" 
                                        BorderThickness="1" BorderBrush="#E0E0E0" Padding="15,8" FontSize="12">
                                    <Button.Template>
                                        <ControlTemplate TargetType="Button">
                                            <Border Background="{TemplateBinding Background}" BorderBrush="{TemplateBinding BorderBrush}" 
                                                    BorderThickness="{TemplateBinding BorderThickness}" CornerRadius="5" 
                                                    Padding="{TemplateBinding Padding}">
                                                <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" />
                                            </Border>
                                        </ControlTemplate>
                                    </Button.Template>
                                </Button>
                            </StackPanel>
                            
                            <!-- Configuration Options -->
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>
                                
                                <StackPanel Grid.Row="0" Grid.Column="0" Margin="0,0,10,15">
                                    <TextBlock Text="{loc:Translate Series}" FontSize="12" Foreground="#7F8C8D" Margin="0,0,0,5" />
                                    <ComboBox SelectedIndex="0" Padding="10,8" BorderBrush="#E0E0E0">
                                        <ComboBoxItem Content="1 série" />
                                        <ComboBoxItem Content="2 séries" />
                                        <ComboBoxItem Content="3 séries" />
                                    </ComboBox>
                                </StackPanel>
                                
                                <StackPanel Grid.Row="0" Grid.Column="1" Margin="10,0,0,15">
                                    <TextBlock Text="{loc:Translate PerSeries}" FontSize="12" Foreground="#7F8C8D" Margin="0,0,0,5" />
                                    <ComboBox SelectedIndex="1" Padding="10,8" BorderBrush="#E0E0E0">
                                        <ComboBoxItem Content="4 participants" />
                                        <ComboBoxItem Content="6 participants" />
                                        <ComboBoxItem Content="8 participants" />
                                    </ComboBox>
                                </StackPanel>
                                
                                <StackPanel Grid.Row="1" Grid.Column="0" Margin="0,0,10,15">
                                    <TextBlock Text="{loc:Translate QualifiedSF}" FontSize="12" Foreground="#7F8C8D" Margin="0,0,0,5" />
                                    <ComboBox SelectedIndex="0" Padding="10,8" BorderBrush="#E0E0E0">
                                        <ComboBoxItem Content="N/A (pas de DF)" />
                                        <ComboBoxItem Content="4 qualifiés" />
                                        <ComboBoxItem Content="6 qualifiés" />
                                    </ComboBox>
                                </StackPanel>
                                
                                <StackPanel Grid.Row="1" Grid.Column="1" Margin="10,0,0,15">
                                    <TextBlock Text="{loc:Translate Finalists}" FontSize="12" Foreground="#7F8C8D" Margin="0,0,0,5" />
                                    <ComboBox SelectedIndex="1" Padding="10,8" BorderBrush="#E0E0E0">
                                        <ComboBoxItem Content="4 finalistes" />
                                        <ComboBoxItem Content="6 finalistes" />
                                        <ComboBoxItem Content="8 finalistes" />
                                    </ComboBox>
                                </StackPanel>
                            </Grid>
                            
                            <!-- Warning Message -->
                            <Border Background="#FFF3CD" BorderBrush="#F0C419" BorderThickness="1" 
                                    CornerRadius="5" Padding="15,10" Margin="0,20,0,0">
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="⚠" FontSize="16" Foreground="#856404" Margin="0,0,10,0" />
                                    <TextBlock Text="{loc:Translate SemifinalsNotNecessaryWarning}" 
                                             FontSize="12" Foreground="#856404" TextWrapping="Wrap" />
                                </StackPanel>
                            </Border>
                        </StackPanel>
                    </ScrollViewer>
                </Grid>
            </Border>
        </Border>
    </Grid>
</UserControl>
